## ğŸ§© Feature 4 â€” Dashboard Administration & Gestion des candidatures

### ğŸ¯ User Story

**Story 1.4.1 â€” Suivi des candidatures dans le dashboard administrateur**
*En tant quâ€™administrateur Ã‰tapSup*,
*je veux* visualiser, filtrer et traiter facilement les candidatures des Ã©tudiants,
*afin de* suivre les dossiers par pays et statut, et de mettre Ã  jour les dÃ©cisions sans effort.

**CritÃ¨res dâ€™acceptation :**

* Une page `/admin/dashboard` accessible uniquement aux comptes administrateurs.
* Cartes statistiques visibles :

  * Nombre total de candidatures
  * RÃ©partition par pays (France, Belgique, Pologne)
  * CA mensuel et annuel (Ã  lâ€™instar de Mareza, valeurs statiques MVP)
* Tableau principal â€œCandidatures reÃ§uesâ€ avec les colonnes :

  * ID, Ã‰tudiant, Formation, Ã‰tablissement, Pays, Statut, Date de soumission
* Boutons dâ€™action :

  * `[Voir dossier]` â†’ ouvre la fiche complÃ¨te du candidat
  * `[Changer statut]` â†’ menu dÃ©roulant (En cours / AcceptÃ©e / RefusÃ©e)
* DonnÃ©es dynamiques synchronisÃ©es avec la base existante (`applications`, `users`, `establishments`).

### âš™ï¸ Prompt Claude â€“ ImplÃ©mentation (Sprint 1)

> **Mission globale :**
> Moderniser la page `/admin/dashboard` pour y intÃ©grer les statistiques et la table de suivi des candidatures, en **rÃ©utilisant les structures, contrÃ´leurs et composants existants**.
> Tu dois **analyser dâ€™abord** comment les candidatures sont actuellement affichÃ©es, filtrÃ©es et reliÃ©es Ã  lâ€™administration, puis **Ã©tendre** ces composants sans casser la logique ni la sÃ©curitÃ© des accÃ¨s.

#### ğŸ§  Analyse prÃ©alable de lâ€™existant

* Identifier :

  * `AdminDashboard.vue` ou `DashboardAdmin.vue`
  * `AdminController`, `ApplicationController`, ou `DashboardController`
  * Routes `GET /api/v1/admin/dashboard`, `GET /api/v1/applications`
* VÃ©rifier chargement des donnÃ©es (Axios, Pinia).
* Observer style et structure des cartes statistiques existantes.
* Diagnostic :

  ```bash
  // Diagnostic Sprint1 - Feature 1.4.1 :
  // Composant dÃ©tectÃ© : AdminDashboard.vue
  // API actuelle : GET /api/v1/applications
  // Auth middleware : isAdmin
  // DÃ©cision : ajouter cartes CA mensuel/annuel et Ã©tendre tableau candidatures
  ```

#### âš™ï¸ Ã‰tapes dâ€™implÃ©mentation

**A. Cartes statistiques**

* Ajouter 3 cartes :

  * Total candidatures (`applications.count()`)
  * RÃ©partition par pays (`groupBy('country')`)
  * CA mensuel / annuel (placeholders ou simulation MVP)
* DonnÃ©es gÃ©nÃ©rÃ©es via `ApplicationController` :

  ```php
  Application::selectRaw('country, COUNT(*) as total')->groupBy('country')->get();
  ```

**B. Tableau des candidatures**

* Colonnes : ID, Ã‰tudiant, Formation, Ã‰tablissement, Pays, Statut, Date.
* Actions :

  * `[Voir dossier]` â†’ `ApplicationDetail.vue`
  * `[Changer statut]` â†’ `PATCH /api/v1/applications/{id}` (dropdown)
* Tri par date descendante, pagination.

**C. Nettoyage interface**

* Supprimer anciens widgets inutiles.
* Section â€œDashboard - Gestion des candidaturesâ€.

#### ğŸ¨ UX / UI

* CohÃ©rence avec les autres vues admin.
* Utiliser `CardStat.vue` et `TableSimple.vue`.
* Badges statut colorÃ©s (Jaune : En cours / Vert : AcceptÃ©e / Rouge : RefusÃ©e).

#### ğŸ”’ SÃ©curitÃ©

* Middleware `isAdmin`.
* DonnÃ©es non sensibles cÃ´tÃ© front.
* Log des changements de statut (Sprint 2).

#### âŒ Ã€ ne pas faire

* Ne pas modifier le schÃ©ma `applications`.
* Ne pas crÃ©er de routes v2 inutiles.
* Ne pas connecter Stripe ici.

#### ğŸ“˜ TraÃ§abilitÃ©

```js
// Sprint1 Update: Feature 1.4.1 â€” Dashboard Administration & Gestion des candidatures (CA mensuel/annuel)
```

`docs/qa/TEST_REPORT.md` â†’

```
Section â€œDashboard Adminâ€ â€” VÃ©rifier statistiques, filtres pays, changement de statut, cartes CA.
```
