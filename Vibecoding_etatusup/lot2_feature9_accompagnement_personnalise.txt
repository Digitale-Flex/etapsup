## ğŸ§© Feature 9 â€” Accompagnement personnalisÃ© (Service Premium)

### ğŸ¯ User Story

**Story 1.9.1 â€” Demande dâ€™accompagnement personnalisÃ©**
*En tant quâ€™Ã©tudiant (Amina)*,
*je veux* pouvoir soumettre une demande dâ€™accompagnement personnalisÃ© (coaching, logement, orientation, etc.),
*afin de* bÃ©nÃ©ficier dâ€™un suivi individuel adaptÃ© Ã  mes besoins, avec paiement du service.

**CritÃ¨res dâ€™acceptation :**

* Page `/accompagnement` accessible depuis le tableau de bord.
* Formulaire simple :

  * Objectif de lâ€™Ã©tudiant (texte libre, 500 caractÃ¨res max).
  * Niveau dâ€™Ã©tudes (liste dÃ©roulante).
  * Pays cible (liste).
* Bouton **[Lancer ma recherche personnalisÃ©e]** â†’ enregistre la demande et initie un paiement premium (Stripe).
* Paiement premium unique (prix fixe).
* Lâ€™administrateur voit la demande dans le dashboard (filtrable par type = accompagnement).
* Pas de logique dâ€™appariement ni dâ€™envoi automatique (prÃ©vu Sprint 2).

### âš™ï¸ Prompt Claude â€“ ImplÃ©mentation (Sprint 1)

> **Mission globale :**
> ImplÃ©menter un formulaire dâ€™accompagnement premium en **rÃ©utilisant la logique de candidature et paiement** existante.
> Avant toute Ã©criture, **analyse comment les candidatures et paiements sont stockÃ©s et reliÃ©s**, puis **Ã©tends** la structure avec un champ â€œtype = accompagnementâ€.

#### ğŸ§  Analyse prÃ©alable de lâ€™existant

* Identifier :

  * Composant Vue pour le formulaire (`AccompagnementForm.vue`, `CustomService.vue`).
  * ContrÃ´leur backend (`ApplicationController`, `ServiceController`).
  * ModÃ¨le `Application` (peut Ãªtre rÃ©utilisÃ©).
  * API Stripe existante (`/api/v1/payments/create`).
* VÃ©rifier :

  * Comment les formulaires crÃ©ent des enregistrements (`Application::create`).
  * Comment les paiements sont associÃ©s Ã  une candidature.
* Diagnostic :

  ```bash
  // Diagnostic Sprint1 - Feature 1.9.1 :
  // Formulaire Ã  crÃ©er : AccompagnementForm.vue
  // Backend : ApplicationController (extension type=accompagnement)
  // Paiement : StripeController (rÃ©utilisation checkout)
  // DÃ©cision : rÃ©utiliser table applications avec champ type
  ```

#### âš™ï¸ Ã‰tapes dâ€™implÃ©mentation

**A. Frontend**

* CrÃ©er la page `/accompagnement`.
* Formulaire minimal :

  ```vue
  <form @submit.prevent="submitForm">
    <textarea v-model="objectif" placeholder="DÃ©cris ton besoin..." maxlength="500" />
    <select v-model="niveau">
      <option value="licence">Licence</option>
      <option value="master">Master</option>
      <option value="doctorat">Doctorat</option>
    </select>
    <select v-model="pays">
      <option v-for="p in countries" :key="p.id" :value="p.name">{{ p.name }}</option>
    </select>
    <button type="submit">Lancer ma recherche personnalisÃ©e</button>
  </form>
  ```
* AprÃ¨s validation â†’ `POST /api/v1/accompagnement`.
* Paiement Stripe : frais premium (ex. 50 â‚¬ en mode test).

**B. Backend**

* Ã‰tendre le modÃ¨le `Application` :

  * Champ `type` (valeur par dÃ©faut = `candidature`).
  * Nouveau type = `accompagnement`.
* `ApplicationController@store` :

  ```php
  Application::create([
      'user_id' => auth()->id(),
      'type' => 'accompagnement',
      'objectif' => $request->objectif,
      'niveau' => $request->niveau,
      'country' => $request->pays,
      'status' => 'En attente de paiement',
  ]);
  ```
* Lancer paiement via `StripeController`.

**C. Dashboard Admin**

* Ajouter un filtre `type = accompagnement`.
* Colonnes : Ã‰tudiant, Objectif, Pays, Statut, Date.

#### ğŸ¨ UX / UI

* Design cohÃ©rent avec le reste du dashboard.
* Message de confirmation aprÃ¨s envoi :
  â€œâœ… Ta demande dâ€™accompagnement a bien Ã©tÃ© enregistrÃ©e. Tu recevras un suivi aprÃ¨s paiement.â€

#### ğŸ”’ SÃ©curitÃ©

* Validation (`objectif`, `niveau`, `pays`).
* Auth obligatoire.
* AccÃ¨s admin restreint pour lecture.

#### âŒ Ã€ ne pas faire

* Ne pas crÃ©er une nouvelle table.
* Ne pas ajouter de moteur de matching.
* Ne pas envoyer dâ€™e-mail automatique.
* Ne pas relier ce paiement Ã  dâ€™autres produits.

#### ğŸ“˜ TraÃ§abilitÃ©

```js
// Sprint1 Update: Feature 1.9.1 â€” Accompagnement personnalisÃ© (formulaire + paiement premium)
```

`docs/qa/TEST_REPORT.md` â†’

```
Section â€œAccompagnement personnalisÃ©â€ â€” VÃ©rifier crÃ©ation, paiement, statut et visibilitÃ© admin.
```
